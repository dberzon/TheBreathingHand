# Recommended Future Features for Breathinghand

Based on the current architecture and musical intent, here are features I'd recommend, organized by priority and complexity:

---

## ğŸ¯ High Priority (Core Experience)

### 1. Visual Chord Display
**Why:** Users currently have no feedback on what chord they're playing.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Cmaj7              â”‚  â† Chord name
â”‚   C  E  G  B            â”‚  â† Note names
â”‚   â—  â—  â—  â—            â”‚  â† Active voices
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Scope:** Add a `ChordDisplayView` overlay showing:
- Current chord symbol (Cmaj7, Dm, Gsus4, etc.)
- Individual note names
- Instability indicator (shows "dim" when grip is closed)

---

### 2. Built-in Audio Engine (Practice Mode)
**Why:** Currently requires external MIDI synth. Users can't practice without setup.

**Implementation options:**
- Integrate Oboe + simple sine/saw oscillators
- Or use Android's `AudioTrack` with basic wavetables
- Low-latency requirement: <15ms

```kotlin
interface AudioEngine {
    fun noteOn(note: Int, velocity: Int, channel: Int)
    fun noteOff(note: Int, channel: Int)
    fun setParameter(param: Int, value: Float)
}
```

---

### 3. Preset/Scale System
**Why:** Currently locked to major/minor/diminished. Musicians need modes.

**Suggested scales:**
| Mode | Intervals | Use Case |
|------|-----------|----------|
| Ionian (Major) | Current default | Happy, bright |
| Dorian | m3, M6 | Jazz, funk |
| Mixolydian | M3, m7 | Blues, rock |
| Pentatonic | 5 notes | Universal |
| Harmonic Minor | m3, M7 | Dramatic |

**Architecture:**
```kotlin
data class ScalePreset(
    val name: String,
    val thirdInterval: Int,      // 3 or 4 semitones
    val fifthInterval: Int,      // 6, 7, or 8
    val seventhInterval: Int,    // 9, 10, or 11
    val allowInstabilityOverride: Boolean
)
```

---

### 4. Haptic Feedback
**Why:** Confirms harmonic changes without looking at screen.

**Trigger points:**
- Sector change (root motion) â†’ short pulse
- Finger count change â†’ double pulse
- Instability threshold crossed â†’ warning vibration
- Transition window hit â†’ subtle confirmation

```kotlin
class HapticFeedback(context: Context) {
    private val vibrator = context.getSystemService(Vibrator::class.java)
    
    fun onSectorChange() = vibrate(VibrationEffect.createOneShot(20, 128))
    fun onInstabilityWarning() = vibrate(VibrationEffect.createWaveform(...))
}
```

---

## ğŸ¨ Medium Priority (Enhanced Expression)

### 5. Chord Inversions via Vertical Position
**Why:** Currently `centerYNorm` only affects initial bias. Could control voicing.

**Concept:**
- Top of screen â†’ Root position
- Middle â†’ First inversion
- Bottom â†’ Second inversion

```kotlin
fun applyInversion(roleNotes: IntArray, centerYNorm: Float, fingerCount: Int) {
    val inversion = when {
        centerYNorm < 0.33f -> 0  // Root position
        centerYNorm < 0.66f -> 1  // First inversion
        else -> 2                  // Second inversion
    }
    // Transpose lower voices up an octave based on inversion
}
```

---

### 6. Arpeggiator Mode
**Why:** Static chords limit rhythmic expression; arpeggios add movement.

**Parameters controlled by gesture:**
- Rate: Finger spread (tight = fast, wide = slow)
- Direction: Angle (up/down/random)
- Gate: Pressure/force

```kotlin
class Arpeggiator(private val clock: MonotonicClock) {
    var pattern: ArpPattern = ArpPattern.UP
    var rateMs: Long = 125  // 8th notes at 120bpm
    var gatePercent: Float = 0.8f
    
    fun tick(notes: IntArray, activeCount: Int): Int? {
        // Returns which note index to play this tick
    }
}
```

---

### 7. Two-Zone Mode (Bass + Chord)
**Why:** Left hand bass, right hand chords is fundamental to keyboard playing.

**Layout:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              â”‚              â”‚
â”‚  BASS ZONE   â”‚  CHORD ZONE  â”‚
â”‚  (1 finger)  â”‚  (1-4 fingers)â”‚
â”‚              â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Behavior:**
- Bass zone: Always plays root (or 5th below) in low octave
- Chord zone: Current behavior
- Bass follows chord zone's root unless locked

---

### 8. Gesture Recording & Looping
**Why:** Build up layers like a loop pedal.

**MVP:**
```kotlin
class GestureRecorder {
    private val events = mutableListOf<TimestampedState>()
    var isRecording = false
    var isPlaying = false
    var loopLengthMs: Long = 4000  // 4 seconds default
    
    fun record(state: HarmonicState, tMs: Long)
    fun playback(tMs: Long): HarmonicState?
}
```

---

### 9. MIDI Clock Sync
**Why:** Integration with DAWs and hardware.

**Features:**
- Send MIDI clock (leader mode)
- Receive MIDI clock (follower mode)
- Tempo-sync arpeggiator/quantization

```kotlin
class MidiClock(private val midi: MidiOut) {
    var bpm: Float = 120f
    var isRunning = false
    
    fun sendTick() = midi.send1(0xF8)  // Timing clock
    fun sendStart() = midi.send1(0xFA)
    fun sendStop() = midi.send1(0xFC)
}
```

---

## ğŸ”§ Lower Priority (Polish & Power Users)

### 10. Sensitivity Calibration UI
**Why:** `SmartInputHAL` auto-calibrates, but users may want manual control.

**Settings screen:**
- Pressure sensitivity curve
- Size-to-force mapping
- Wack detection threshold
- Show live sensor values (debug mode)

---

### 11. Custom CC Mapping
**Why:** Different synths use different CCs for brightness, etc.

```kotlin
data class CCMapping(
    val parameter: GestureParameter,  // DX, DY, FORCE, SPREAD
    val ccNumber: Int,
    val minValue: Int = 0,
    val maxValue: Int = 127,
    val curve: ResponseCurve = ResponseCurve.LINEAR
)
```

---

### 12. Landscape Mode with Extended Range
**Why:** Tablet users want more screen real estate.

**Concept:**
- Landscape splits into 2 octave zones
- Or provides larger gesture area
- Circle-of-fifths could show full 12 sectors visibly

---

### 13. OSC Output (Open Sound Control)
**Why:** Integration with Max/MSP, SuperCollider, TouchDesigner.

```kotlin
class OscOut(private val host: String, private val port: Int) {
    fun send(address: String, vararg args: Any)
    // e.g., send("/breathinghand/chord", "Cmaj7", 60, 64, 67, 71)
}
```

---

### 14. Session Recording to MIDI File
**Why:** Export performances for editing in DAW.

**Scope:**
- Record all MIDI events with timestamps
- Export as Standard MIDI File (Type 0 or 1)
- Share via system intent

---

### 15. Accessibility: VoiceOver/TalkBack Support
**Why:** Screen reader users should get audio feedback on chord changes.

```kotlin
fun announceChord(state: HarmonicState) {
    val chordName = ChordNamer.name(state)  // "C major seven"
    accessibilityManager.announce(chordName)
}
```

---

## ğŸ“Š Feature Prioritization Matrix

| Feature | User Impact | Dev Effort | Dependencies |
|---------|-------------|------------|--------------|
| Visual Chord Display | â­â­â­â­â­ | Low | None |
| Haptic Feedback | â­â­â­â­ | Low | None |
| Scale/Preset System | â­â­â­â­â­ | Medium | Refactor HarmonicFieldMap |
| Built-in Audio | â­â­â­â­â­ | High | Oboe integration |
| Inversions | â­â­â­ | Low | None |
| Arpeggiator | â­â­â­â­ | Medium | Clock system |
| Two-Zone Mode | â­â­â­ | Medium | Touch routing |
| Gesture Looping | â­â­â­ | High | Timing system |
| MIDI Clock | â­â­â­ | Medium | MidiOut extension |
| Calibration UI | â­â­ | Medium | Settings activity |
| Custom CC | â­â­ | Low | Config system |
| Landscape Mode | â­â­ | Medium | Layout rework |
| OSC Output | â­â­ | Medium | Network permissions |
| MIDI File Export | â­â­â­ | Medium | File I/O |
| Accessibility | â­â­â­ | Low | None |

---

## ğŸš€ Suggested Roadmap

### Phase 1: Visual & Feedback (1-2 weeks)
- [ ] Chord name display
- [ ] Haptic feedback
- [ ] Fix bugs from code review

### Phase 2: Musical Depth (2-4 weeks)
- [ ] Scale/mode presets
- [ ] Chord inversions
- [ ] Calibration settings UI

### Phase 3: Expression (4-6 weeks)
- [ ] Built-in audio engine
- [ ] Arpeggiator
- [ ] MIDI clock sync

### Phase 4: Advanced (6+ weeks)
- [ ] Two-zone mode
- [ ] Gesture looping
- [ ] MIDI file export

---

Would you like me to elaborate on any of these features with more detailed specifications or architecture suggestions?